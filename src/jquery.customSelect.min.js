(function(a){var b="ui-customSelect-open",c="ui-customRange-disabled",d="customselect";a.widget("ui.customSelect",{options:{multimode:{placeholder:"Please select some items",defaultValue:null}},_create:function(){var e=this,f=e.options.multimode.defaultValue,g=this.element,h,i=[],j=!1;if(!g.is("select"))throw new TypeError("jquery.customSelect expects a <select> element.");e.rootId=g.attr("id")+"_customSelect",i.push('<div class="ui-customSelect">'),i.push('  <div class="ui-customSelect-window"><span></span>'),i.push('    <div class="ui-customSelect-arrow ui-customSelect-downArrow">&#x25BC;</div>'),i.push('    <div class="ui-customSelect-arrow ui-customSelect-upArrow">&#x25B2;</div>'),i.push("  </div>"),i.push('  <div class="ui-customSelect-dropdown"><ul></ul></div>'),i.push("</div>"),this.root=h=a(i.join("")).attr("id",e.rootId),g.after(h).hide(),this.window=h.find(".ui-customSelect-window span"),this.list=h.find("ul"),e._createFromSelect(),e._setWindowText(),e.window.parent().click(function(a){e._trigger(j?"blur":"focus",a)}),h.delegate("li>input","change",function(a){e._setWindowText(),g.val(e.getVal()).trigger("change"),e._trigger("change",a)}),g.bind(d+"focus",function(){h.hasClass(c)||(j=!0,h.addClass(b),a(document).bind("click.customRange"+e.rootId,function(b){a.contains(h[0],b.target)||e._trigger("blur")}))}).bind(d+"blur",function(){a(document).unbind("click.customRange"+e.rootId),j=!1,h.removeClass(b)}).bind(d+"disabled",function(){h.addClass(c),j&&e._trigger("blur")}).bind(d+"enabled",function(){h.removeClass(c)});if(e.isMultiple&&f){function k(){e.getVal().length||e.list.find("input[value="+f+"]").attr("checked",!0).change()}g.bind(d+"change",k),k()}},getVal:function(){var a=this.root.find("li>input:checked").map(function(){return this.value}).toArray();return a.length?a[this.isMultiple?"slice":"pop"]():this.isMultiple?[]:null},friendlyVal:function(){return this.root.find("input:checked+label").map(function(){return this.innerHTML}).toArray()},_setWindowText:function(){var a=this.friendlyVal();this.window.html(a.length?a.join(", "):this.options.multimode.placeholder)},_createFromSelect:function(){var b=this,c=0,d=b.list,e=d.prev()[0]||d.parent();b.isMultiple=b.element.attr("multiple"),d.empty(),this.element.children().each(function(){var e=this,f=b.rootId+"_"+c++,g='<label for="'+f+'">'+e.innerHTML+"</label>",h;b.isMultiple?h=a('<input id="'+f+'" type="checkbox" value="'+e.value+'">'):h=a('<input id="'+f+'" name="'+b.rootId+'_radio" type="radio" value="'+e.value+'">'),d.append(a("<li></li>").append(h).append(" ").append(g)),e.selected&&h.attr("checked",!0)})},reload:function(){this._createFromSelect()},_setOption:function(a,b){a==="disabled"&&this._trigger((b?"dis":"en")+"abled")},destroy:function(){a.Widget.prototype.destroy.apply(this,arguments),a(document).unbind("click.customRange"+this.rootId),this.root.remove(),this.element.show()}})})(jQuery)